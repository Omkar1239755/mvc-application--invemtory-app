!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.ejs=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function o(a,b){var d;if("/"==a.charAt(0))d=c.resolveInclude(a.replace(/^\/*/,""),b.root||"/",!0);else{if(!b.filename)throw new Error("`include` use relative path requires the 'filename' option.");d=c.resolveInclude(a,b.filename)}return d}function p(a,b){var d;if("/"==a.charAt(0))d=c.resolveLayout(a.replace(/^\/*/,""),b.root||"/",!0);else{if(!b.filename)throw new Error("`include` use relative path requires the 'filename' option.");includePath=c.resolveLayout(a,b.filename)}return d}function q(a,b){var e,f=a.filename,g=arguments.length>1;if(a.cache){if(!f)throw new Error("cache option requires a filename");if(e=c.cache.get(f))return e;g||(b=d.readFileSync(f).toString().replace(n,""))}else if(!g){if(!f)throw new Error("Internal EJS error: no file name or template provided");b=d.readFileSync(f).toString().replace(n,"")}return e=c.compile(b,a),a.cache&&c.cache.set(f,e),e}function r(a,b){var c=f.shallowCopy({},b);return c.filename=o(a,c),q(c)}function t(a,b){var e,g,c=f.shallowCopy({},b);e=o(a,c),g=d.readFileSync(e).toString().replace(n,""),c.filename=e;var h=new w(g,c);return h.generateSource(),{source:h.source,filename:e,template:g}}function u(a,b,c,d){var e=b.split("\n"),f=Math.max(d-3,0),g=Math.min(e.length,d+3),h=e.slice(f,g).map(function(a,b){var c=b+f+1;return(c==d?" >> ":"    ")+c+"| "+a}).join("\n");throw a.path=c,a.message=(c||"ejs")+":"+d+"\n"+h+"\n\n"+a.message,a}function v(a,b){l.forEach(function(c){"undefined"!=typeof a[c]&&(b[c]=a[c])})}function w(a,b){b=b||{};var d={};this.templateText=a,this.mode=null,this.truncate=!1,this.currentLine=1,this.source="",this.variable="",this.dependencies=[],d.client=b.client||!1,d.escapeFunction=b.escape||f.escapeXML,d.compileDebug=b.compileDebug!==!1,d.debug=!!b.debug,d.filename=b.filename,d.delimiter=b.delimiter||c.delimiter||i,d.strict=b.strict||!1,d.context=b.context,d.cache=b.cache||!1,d.rmWhitespace=b.rmWhitespace,d.root=b.root,d.localsName=b.localsName||c.localsName||j,d.strict?d._with=!1:d._with="undefined"==typeof b._with||b._with,this.opts=d,this.regex=this.createRegex(),this.sectionStatus={status:"close",isEndLine:!0,section:""},this.sectionContent={}}function x(a,b){var c=a.settings.views;return c+"/"+b+".ejs"}var d=a("fs"),e=a("path"),f=a("./utils"),g=!1,h=a("../package.json").version,i="%",j="locals",k="(<%%|%%>|<%=|<%-|<%_|<%#|<%\\+|<%|%>|-%>|_%>)",l=["cache","filename","delimiter","scope","context","debug","compileDebug","client","_with","root","rmWhitespace","strict","localsName"],m=/;\s*$/,n=/^\uFEFF/;c.cache=f.cache,c.localsName=j,c.resolveInclude=function(a,b,c){var d=e.dirname,f=e.extname,g=e.resolve,h=g(c?b:d(b),a),i=f(a);return i||(h+=".ejs"),h},c.resolveLayout=function(a,b,c){var d=e.dirname,f=e.extname,g=e.resolve,h=g(c?b:d(b),a),i=f(a);return i||(h+=".ejs"),h},c.layoutSource=function(a,b){var e,g,c=f.shallowCopy({},b);e=p(a,c),g=d.readFileSync(e).toString().replace(n,""),c.filename=e;var h=new w(g,c);return h.generateSource(),{source:h.source,filename:e,template:g}},c.compile=function(b,c){var d;return c&&c.scope&&(g||(console.warn("`scope` option is deprecated and will be removed in EJS 3"),g=!0),c.context||(c.context=c.scope),delete c.scope),d=new w(b,c),d.compile()},c.render=function(a,b,c){var d=b||{},e=c||{};return 2==arguments.length&&v(d,e),q(e,a)(d)},c.renderFile=function(){var g,a=Array.prototype.slice.call(arguments),b=a.shift(),c=a.pop(),d=a.shift()||{},e=a.pop()||{};e=f.shallowCopy({},e),3==arguments.length&&(d.settings&&d.settings["view options"]?v(d.settings["view options"],e):v(d,e)),e.filename=b;try{g=q(e)(d)}catch(a){return c(a)}return c(null,g)},c.clearCache=function(){c.cache.reset()},w.modes={EVAL:"eval",ESCAPED:"escaped",LAYOUT:"layout",RAW:"raw",COMMENT:"comment",LITERAL:"literal"},w.prototype={getSectionContent:function(){return this.sectionContent},createRegex:function(){var a=k,b=f.escapeRegExpChars(this.opts.delimiter);return a=a.replace(/%/g,b),new RegExp(a)},compile:function(){var a,b,c=this.opts,d="",e="",g=c.escapeFunction;this.source||(this.generateSource(),d+="  var __output = [], __append = __output.push.bind(__output);\n",c._with!==!1&&(d+="  with ("+c.localsName+" || {}) {\n",e+="  }\n"),e+='  return __output.join("");\n',this.source=d+this.source+e,Object.keys(this.sectionContent).length>0?global.sectionContent=this.sectionContent:""),a=c.compileDebug?"var __line = 1\n  , __lines = "+JSON.stringify(this.templateText)+"\n  , __filename = "+(c.filename?JSON.stringify(c.filename):"undefined")+";\ntry {\n"+this.source+"} catch (e) {\n  rethrow(e, __lines, __filename, __line);\n}\n":this.source,c.debug&&console.log(a),c.client&&(a="escape = escape || "+g.toString()+";\n"+a,c.compileDebug&&(a="rethrow = rethrow || "+u.toString()+";\n"+a)),c.strict&&(a='"use strict";\n'+a);try{b=new Function(c.localsName+", escape, include, rethrow",a)}catch(a){throw a instanceof SyntaxError&&(c.filename&&(a.message+=" in "+c.filename),a.message+=" while compiling ejs"),a}if(c.client)return b.dependencies=this.dependencies,b;var h=function(a){var d=function(b,d){var e=f.shallowCopy({},a);return d&&(e=f.shallowCopy(e,d)),r(b,c)(e)};return b.apply(c.context,[a||{},g,d,u])};return h.dependencies=this.dependencies,h},generateSource:function(){var a=this.opts;a.rmWhitespace&&(this.templateText=this.templateText.replace(/\r/g,"").replace(/^\s+|\s+$/gm,"")),this.templateText=this.templateText.replace(/[ \t]*<%_/gm,"<%_").replace(/_%>[ \t]*/gm,"_%>");var b=this,d=this.parseTemplateText(),e=this.opts.delimiter;d&&d.length&&d.forEach(function(a,g){var h,i,j,k,l,m;if(0===a.indexOf("<"+e)&&0!==a.indexOf("<"+e+e)&&(i=d[g+2],i!=e+">"&&i!="-"+e+">"&&i!="_"+e+">"))throw new Error('Could not find matching close tag for "'+a+'".');return(j=a.match(/^\s*include\s+(\S+)/))&&(h=d[g-1],h&&(h=="<"+e||h=="<"+e+"-"||h=="<"+e+"_"||h=="<"+e+"+"))?(k=f.shallowCopy({},b.opts),l=t(j[1],k),m=b.opts.compileDebug?"    ; (function(){\n      var __line = 1\n      , __lines = "+JSON.stringify(l.template)+"\n      , __filename = "+JSON.stringify(l.filename)+";\n      try {\n"+l.source+"      } catch (e) {\n        rethrow(e, __lines, __filename, __line);\n      }\n    ; }).call(this)\n":"    ; (function(){\n"+l.source+"    ; }).call(this)\n",b.source+=m,void b.dependencies.push(c.resolveInclude(j[1],k.filename))):void b.scanLine(a)})},parseTemplateText:function(){for(var e,a=this.templateText,b=this.regex,c=b.exec(a),d=[];c;)e=c.index,0!==e&&(d.push(a.substring(0,e)),a=a.slice(e)),d.push(c[0]),a=a.slice(c[0].length),c=b.exec(a);return a&&d.push(a),d},scanLine:function(a){var b=this,d=(this.opts.delimiter,0);d=a.split("\n").length-1,"close"==b.sectionStatus.status&&this.scanLineSource(a),"open"==b.sectionStatus.status&&this.scanLineSection(a,this.sectionStatus.section)},scanLineSource:function(a){function e(){b.truncate?(a=a.replace(/^(?:\r\n|\r|\n)/,""),b.truncate=!1):b.opts.rmWhitespace&&(a=a.replace(/^\n/,"")),a&&(a=a.replace(/\\/g,"\\\\"),a=a.replace(/\n/g,"\\n"),a=a.replace(/\r/g,"\\r"),a=a.replace(/"/g,'\\"'),b.source+='    ; __append("'+a+'")\n')}var b=this,c=this.opts.delimiter,d=0;switch(a){case"<"+c:case"<"+c+"_":this.mode=w.modes.EVAL;break;case"<"+c+"=":this.mode=w.modes.ESCAPED;break;case"<"+c+"+":this.mode=w.modes.LAYOUT;break;case"<"+c+"-":this.mode=w.modes.RAW;break;case"<"+c+"#":this.mode=w.modes.COMMENT;break;case"<"+c+c:this.mode=w.modes.LITERAL,this.source+='    ; __append("'+a.replace("<"+c+c,"<"+c)+'")\n';break;case c+c+">":this.mode=w.modes.LITERAL,this.source+='    ; __append("'+a.replace(c+c+">",c+">")+'")\n';break;case c+">":b.sectionStatus.isEndLine?this.mode==w.modes.LITERAL&&e():b.sectionStatus.isEndLine=!0;case"-"+c+">":case"_"+c+">":this.mode==w.modes.LITERAL&&e(),this.mode=null,this.truncate=0===a.indexOf("-")||0===a.indexOf("_");break;default:if(this.mode){switch(this.mode){case w.modes.EVAL:case w.modes.ESCAPED:case w.modes.LAYOUT:case w.modes.RAW:a.lastIndexOf("//")>a.lastIndexOf("\n")&&(a+="\n")}switch(this.mode){case w.modes.EVAL:this.source+="    ; "+a+"\n",this.variable+="    ; "+a+"\n";break;case w.modes.ESCAPED:this.source+="    ; __append(escape("+a.replace(m,"").trim()+"))\n";break;case w.modes.LAYOUT:b.sectionStatus.isEndLine=!1,this.layoutContent=a.replace(m,"").trim()+")\n";var g=f.isBlockSingle(this.layoutContent);g.name&&(this.sectionContent[g.name]=this.variable+"    ; __append("+g.value.replace(m,"").trim()+")\n");var g=f.isOpenBlock(this.layoutContent);g&&(this.sectionStatus.status="open",this.sectionStatus.section=g,this.sectionContent[g]=this.variable);var h=f.isLayoutTag(this.layoutContent);h&&(global.layoutPath=h);var i=f.isYield(this.layoutContent);i&&(this.source+=global.sectionContent[i]);break;case w.modes.RAW:this.source+="    ; __append("+a.replace(m,"").trim()+")\n";break;case w.modes.COMMENT:break;case w.modes.LITERAL:e()}}else e()}b.opts.compileDebug&&d&&(this.currentLine+=d,this.source[g]+="    ; __line = "+this.currentLine+"\n")},scanLineSection:function(a,b){function g(){c.truncate?(a=a.replace(/^(?:\r\n|\r|\n)/,""),c.truncate=!1):c.opts.rmWhitespace&&(a=a.replace(/^\n/,"")),a&&(a=a.replace(/\\/g,"\\\\"),a=a.replace(/\n/g,"\\n"),a=a.replace(/\r/g,"\\r"),a=a.replace(/"/g,'\\"'),c.sectionContent[b]+='    ; __append("'+a+'")\n')}var c=this,d=this.opts.delimiter,e=0;switch(a){case"<"+d:case"<"+d+"_":this.mode=w.modes.EVAL;break;case"<"+d+"=":this.mode=w.modes.ESCAPED;break;case"<"+d+"+":this.mode=w.modes.LAYOUT;break;case"<"+d+"-":this.mode=w.modes.RAW;break;case"<"+d+"#":this.mode=w.modes.COMMENT;break;case"<"+d+d:this.mode=w.modes.LITERAL,this.sectionContent[b]+='    ; __append("'+a.replace("<"+d+d,"<"+d)+'")\n';break;case d+d+">":this.mode=w.modes.LITERAL,this.sectionContent[b]+='    ; __append("'+a.replace(d+d+">",d+">")+'")\n';break;case d+">":c.sectionStatus.isEndLine?this.mode==w.modes.LITERAL&&g():c.sectionStatus.isEndLine=!0;case"-"+d+">":case"_"+d+">":this.mode==w.modes.LITERAL&&g(),this.mode=null,this.truncate=0===a.indexOf("-")||0===a.indexOf("_");break;default:if(this.mode){switch(this.mode){case w.modes.EVAL:case w.modes.ESCAPED:case w.modes.LAYOUT:case w.modes.RAW:a.lastIndexOf("//")>a.lastIndexOf("\n")&&(a+="\n")}switch(this.mode){case w.modes.EVAL:this.sectionContent[b]+="    ; "+a+"\n";break;case w.modes.ESCAPED:this.sectionContent[b]+="    ; __append(escape("+a.replace(m,"").trim()+"))\n";break;case w.modes.LAYOUT:c.sectionStatus.isEndLine=!1,this.layoutContent=a.replace(m,"").trim()+")\n",f.isCloseBlock(this.layoutContent)&&(c.sectionStatus.status="close");break;case w.modes.RAW:this.sectionContent[b]+="    ; __append("+a.replace(m,"").trim()+")\n";break;case w.modes.COMMENT:break;case w.modes.LITERAL:g()}}else g()}c.opts.compileDebug&&e&&(this.currentLine+=e,this.sectionContent[b]+="    ; __line = "+this.currentLine+"\n")}},c.main=function(a,b,d){c.renderFile(a,b,function(a,e){if(global.layoutPath){var f=x(b,global.layoutPath);c.renderFile(f,b,function(a,b){d(a,b)})}else d(a,e)})},c.escapeXML=f.escapeXML,c.__express=c.main,a.extensions&&(a.extensions[".ejs"]=function(a,b){var e=b||a.filename,f={filename:e,client:!0},g=d.readFileSync(e).toString(),h=c.compile(g,f);a._compile("module.exports = "+h.toString()+";",e)}),c.VERSION=h,"undefined"!=typeof window&&(window.ejs=c)},{"../package.json":6,"./utils":2,fs:3,path:4}],2:[function(a,b,c){"use strict";function g(a){return e[a]||a}var d=/[|\\{}()[\]^$+*?.]/g;c.escapeRegExpChars=function(a){return a?String(a).replace(d,"\\$&"):""};var e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"},f=/[&<>\'"]/g,h='var _ENCODE_HTML_RULES = {\n      "&": "&amp;"\n    , "<": "&lt;"\n    , ">": "&gt;"\n    , \'"\': "&#34;"\n    , "\'": "&#39;"\n    }\n  , _MATCH_HTML = /[&<>\'"]/g;\nfunction encode_char(c) {\n  return _ENCODE_HTML_RULES[c] || c;\n};\n';c.escapeXML=function(a){return void 0==a?"":String(a).replace(f,g)},c.escapeXML.toString=function(){return Function.prototype.toString.call(this)+";\n"+h},c.shallowCopy=function(a,b){b=b||{};for(var c in b)a[c]=b[c];return a},c.cache={_data:{},set:function(a,b){this._data[a]=b},get:function(a){return this._data[a]},reset:function(){this._data={}}}},{}],3:[function(a,b,c){},{}],4:[function(a,b,c){(function(a){function b(a,b){for(var c=0,d=a.length-1;d>=0;d--){var e=a[d];"."===e?a.splice(d,1):".."===e?(a.splice(d,1),c++):c&&(a.splice(d,1),c--)}if(b)for(;c--;c)a.unshift("..");return a}function f(a,b){if(a.filter)return a.filter(b);for(var c=[],d=0;d<a.length;d++)b(a[d],d,a)&&c.push(a[d]);return c}var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,e=function(a){return d.exec(a).slice(1)};c.resolve=function(){for(var c="",d=!1,e=arguments.length-1;e>=-1&&!d;e--){var g=e>=0?arguments[e]:a.cwd();if("string"!=typeof g)throw new TypeError("Arguments to path.resolve must be strings");g&&(c=g+"/"+c,d="/"===g.charAt(0))}return c=b(f(c.split("/"),function(a){return!!a}),!d).join("/"),(d?"/":"")+c||"."},c.normalize=function(a){var d=c.isAbsolute(a),e="/"===g(a,-1);return a=b(f(a.split("/"),function(a){return!!a}),!d).join("/"),a||d||(a="."),a&&e&&(a+="/"),(d?"/":"")+a},c.isAbsolute=function(a){return"/"===a.charAt(0)},c.join=function(){var a=Array.prototype.slice.call(arguments,0);return c.normalize(f(a,function(a,b){if("string"!=typeof a)throw new TypeError("Arguments to path.join must be strings");return a}).join("/"))},c.relative=function(a,b){function d(a){for(var b=0;b<a.length&&""===a[b];b++);for(var c=a.length-1;c>=0&&""===a[c];c--);return b>c?[]:a.slice(b,c-b+1)}a=c.resolve(a).substr(1),b=c.resolve(b).substr(1);for(var e=d(a.split("/")),f=d(b.split("/")),g=Math.min(e.length,f.length),h=g,i=0;i<g;i++)if(e[i]!==f[i]){h=i;break}for(var j=[],i=h;i<e.length;i++)j.push("..");return j=j.concat(f.slice(h)),j.join("/")},c.sep="/",c.delimiter=":",c.dirname=function(a){var b=e(a),c=b[0],d=b[1];return c||d?(d&&(d=d.substr(0,d.length-1)),c+d):"."},c.basename=function(a,b){var c=e(a)[2];return b&&c.substr(-1*b.length)===b&&(c=c.substr(0,c.length-b.length)),c},c.extname=function(a){return e(a)[3]};var g="b"==="ab".substr(-1)?function(a,b,c){return a.substr(b,c)}:function(a,b,c){return b<0&&(b=a.length+b),a.substr(b,c)}}).call(this,a("_process"))},{_process:5}],5:[function(a,b,c){function g(){if(!f){f=!0;for(var a,b=e.length;b;){a=e,e=[];for(var c=-1;++c<b;)a[c]();b=e.length}f=!1}}function h(){}var d=b.exports={},e=[],f=!1;d.nextTick=function(a){e.push(a),f||setTimeout(g,0)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=h,d.addListener=h,d.once=h,d.off=h,d.removeListener=h,d.removeAllListeners=h,d.emit=h,d.binding=function(a){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(a){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},{}],6:[function(a,b,c){b.exports={name:"ejs",description:"Embedded JavaScript templates",keywords:["template","engine","ejs"],version:"2.5.1",author:"Matthew Eernisse <mde@fleegix.org> (http://fleegix.org)",contributors:["Timothy Gu <timothygu99@gmail.com> (https://timothygu.github.io)"],license:"Apache-2.0",main:"./lib/ejs.js",repository:{type:"git",url:"git://github.com/mde/ejs.git"},bugs:"https://github.com/mde/ejs/issues",homepage:"https://github.com/mde/ejs",dependencies:{},devDependencies:{browserify:"^13.0.1",eslint:"^3.0.0",istanbul:"~0.4.3",jake:"^8.0.0",jsdoc:"^3.4.0","lru-cache":"^4.0.1",mocha:"^3.0.2",rimraf:"^2.2.8","uglify-js":"^2.6.2"},engines:{node:">=0.10.0"},scripts:{test:"mocha",coverage:"istanbul cover node_modules/mocha/bin/_mocha",doc:"rimraf out && jsdoc -c jsdoc.json lib/* docs/jsdoc/*",devdoc:"rimraf out && jsdoc -p -c jsdoc.json lib/* docs/jsdoc/*"}}},{}]},{},[1])(1)});
